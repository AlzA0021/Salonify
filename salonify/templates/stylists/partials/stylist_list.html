{% load stylists_extra %}

{% for stylist in stylists %}
<div class="card mb-4" style="border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
    <div class="card-body d-flex">
        <!-- تصویر پروفایل -->
        <img src="{{ stylist.profile_image.url }}" class="profile-img mr-3" alt="{{ stylist.user.name }}" style="border: 2px solid #eee;">
        
        <!-- اطلاعات آرایشگر -->
        <div style="flex-grow: 1;">
            <h5 style="font-weight: bold; color: #333;">{{ stylist.user.name }} {{ stylist.user.family }}</h5>
            <p>امتیاز:
                <span class="rating-stars" style="color: #FFD700;">
                    {% for i in 1|make_range:5 %}
                        {% if i <= stylist.get_average_score %}
                            ★
                        {% else %}
                            ☆
                        {% endif %}
                    {% endfor %}
                </span>
                ({{ stylist.get_average_score }}/5)
            </p>
            {% comment %} <p>قیمت: {{ stylist|get_price_for_service:service }} تومان</p> {% endcomment %}
            <p>سالن:
                {% for salon in stylist.stylists_of_salon.all %}
                 {{ salon.salon_name }}</p>
            {% endfor %}

            <a href="#" class="btn btn-info btn-sm mt-2">مشاهده جزئیات</a>
        </div>

        <!-- دکمه رزرو -->
        <div class="ml-auto">
            <a href="#" class="btn btn-reserve" style="background-color: #4CAF50; color: white; padding: 10px 20px; border-radius: 5px;">
                رزرو
            </a>
        </div>
    </div>

    <!-- دکمه نمایش نظرات -->
    <button class="btn btn-link btn-sm mt-3" data-toggle="collapse" data-target="#commentsCollapse{{ forloop.counter }}" style="color: #007BFF;">
        نظرات ({{ stylist.comments_stylist.count }})
    </button>

    <!-- محتوای قابل جمع شدن (نظرات) -->
    <div id="commentsCollapse{{ forloop.counter }}" class="collapse mt-3" style="background: #f9f9f9; padding: 15px; border-radius: 5px;">
        {% for comment in stylist.comments_stylist.all %}
            <div class="comment mb-3" style="border-bottom: 1px solid #e9e9e9; padding-bottom: 10px;">
                <p><strong>{{ comment.comment_user.user.name }} {{ comment.comment_user.user.family }}:</strong> {{ comment.comment_text }}</p>
            </div>
        {% empty %}
            <p>هیچ نظری وجود ندارد.</p>
        {% endfor %}
    </div>
</div>
{% endfor %}
